---
title: "A summary of the tweets generated at the 2019 CEFP workshop"
author: "Rayna M Harris"
output: md_document
---

```{r setup, echo=FALSE, warning=F, message=F}
## load packages
library(rtweet) # for fetching twitter data
library(dplyr) # for filter and select
library(tidyr) # for gather function
library(knitr) # for pretty tables

# set default code output to False
knitr::opts_chunk$set(echo = F)

# set figure directory
knitr::opts_chunk$set(fig.path = 'rtweets_CEFP2019_figs/')

```


```{r fetch tweets, message=F}
## first, follow steps in <https://rtweet.info/> to setup API and relevant tokens

## search for 18000 tweets using the rstats hashtag
rt <- search_tweets(
  "#CEFP2019", n = 18000, include_rts = FALSE
)
```

### Basic summary

There were a total of **`r nrow(rt)`** tweets with the #CEFP2019 hashtag. These tweets were authored by **`r length(unique(rt$screen_name))`** different particpants. 


```{r tweet_timeline}
# tweet timeline
ts_plot(rt, "2 hours") +
  ggplot2::theme_minimal() +
  ggplot2::theme(plot.title = ggplot2::element_text(face = "bold")) +
  ggplot2::labs(
    x = NULL, y = NULL,
    title = "Frequency of #CEFP tweets",
    subtitle = "Twitter status (tweet) counts aggregated using two-hour intervals",
    caption = "\nSource: Data collected from Twitter's REST API via rtweet"
  )

```

### The 5 most favorited tweets

```{r top5favs}
top5favs <- rt %>%
  top_n(5, favorite_count) %>%
  arrange(desc(favorite_count)) %>%
  select(screen_name, text)
top5favs <- as.data.frame(top5favs)
top5favs
```

### The 5 most retweeted tweets

```{r topretweets, results='asis'}
topretweets <- rt %>%
  top_n(5, retweet_count) %>%
  arrange(desc(retweet_count)) %>%
  select(screen_name, text)
#topretweets <- as.data.frame(topretweets)
topretweets

kable(topretweets)
```

### Top Tweeters

```{r topusers}
top_users <- rt %>%
    group_by(screen_name) %>%
    summarize(total_tweets = n()) 

ggplot(top_users) + 
  geom_bar(aes(x = reorder(screen_name, total_tweets), y = total_tweets), 
           stat = "identity") +
  ylab("Number of tweets") + 
  xlab("User") +
  coord_flip() +
  scale_fill_manual(values = wes_palette("Zissou1")[c(1, 3)]) +
  theme_minimal() +
  theme(axis.text = element_text(size = 8),
  legend.text = element_text(size = 8))
```

### Impact 

The figures below only include users who created three or more original tweets.

```{r}
impact <- rt %>%
    group_by(screen_name) %>%
    summarize(n_tweets = n(),
              n_fav = sum(favorite_count),
              n_rt =  sum(retweet_count),
              mean_fav = mean(favorite_count),
              mean_rt = mean(retweet_count)) %>%
    filter(n_tweets >=  3)
impact
```

### Acknowledgment

This code was adapted from Fran√ßois Michonneau's [code](https://github.com/fmichonneau/2018-carpentrycon-tweets/blob/master/index.Rmd) that he used to create this [blog post about twitter statistics from Carpentry Con 2018](https://carpentries.org/2018/06/carpentrycon-tweets). The [`rtweet` package](https://rtweet.info/) had excellent documentation.